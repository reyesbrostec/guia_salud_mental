<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Guía de Salud Mental</title>
    <!-- CDN de Tailwind CSS para el estilizado -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Referencia a la librería de Markdown-it -->
    <script src="https://cdn.jsdelivr.net/npm/markdown-it@13.0.1/dist/markdown-it.min.js"></script>
    <style>
        .prose img {
            max-width: 100%;
            height: auto;
            border-radius: 0.5rem; /* rounded-lg */
            margin-bottom: 1rem; /* mb-4 */
        }
    </style>
</head>
<body class="bg-gray-50 font-sans leading-normal tracking-normal text-gray-800">

    <!-- Contenedor principal de la aplicación -->
    <div id="app" class="flex flex-col min-h-screen">

        <!-- Encabezado y navegación del blog -->
        <header class="bg-white shadow-md p-6">
            <div class="container mx-auto flex items-center justify-between">
                <div id="home-link" class="text-3xl font-bold text-gray-900 cursor-pointer">Guía de Salud Mental</div>
                <input
                    type="text"
                    placeholder="Buscar técnica..."
                    class="w-full md:w-1/3 px-4 py-2 border rounded-full focus:outline-none focus:ring-2 focus:ring-indigo-500 hidden"
                />
            </div>
        </header>

        <!-- Contenido principal: publicaciones y filtros -->
        <main class="container mx-auto mt-8 p-4 flex-grow">
            <div id="blog-view" class="flex flex-col lg:flex-row gap-8">

                <!-- Barra lateral para filtros de categorías -->
                <aside class="w-full lg:w-1/4">
                    <div class="bg-white rounded-xl shadow-lg p-6 sticky top-8">
                        <h3 class="font-semibold text-lg text-gray-900 mb-4">Categorías</h3>
                        <div id="category-filters" class="flex flex-wrap lg:flex-col gap-2">
                            <!-- Los botones de categoría se renderizarán aquí -->
                        </div>
                    </div>
                </aside>

                <!-- Sección principal para mostrar las publicaciones -->
                <section class="w-full lg:w-3/4">
                    <div
                        id="blog-posts"
                        class="grid gap-6 sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-2"
                    >
                        <!-- Las publicaciones del blog se renderizarán aquí -->
                    </div>
                </section>
            </div>
        </main>

        <!-- Pie de página con el aviso legal -->
        <footer class="bg-gray-800 text-white p-6 mt-8">
            <div class="container mx-auto text-center text-sm">
                <p class="mb-2">© 2024 Guía de Salud Mental. Todos los derechos reservados.</p>
                <p class="text-gray-400">
                    Aviso Legal: Este blog es una herramienta educativa de apoyo y no debe ser considerado un sustituto de la terapia profesional, el diagnóstico o el tratamiento médico. Si necesitas ayuda, consulta a un profesional de la salud mental calificado.
                </p>
            </div>
        </footer>
    </div>

    <!-- Script para la lógica del blog -->
    <script>
        // build.js debe insertar aquí la variable blogPosts
        let blogPosts = [
  {
    "title": "Título del artículo",
    "description": "Aquí va el contenido del artículo en Markdown.",
    "tags": [],
    "summary": "Aquí va el contenido del artículo en Markdown.",
    "slug": "plantilla",
    "raw": "---\r\ntitle: \"Título del artículo\"\r\ncategory: \"Categoría\"\r\ndate: \"2024-08-12\"\r\nsummary: \"Un breve resumen o introducción del artículo, que se mostrará en el listado.\"\r\n---\r\n\r\n# Título principal\r\n\r\nAquí va el contenido del artículo en **Markdown**.\r\n\r\nPuedes usar listas, imágenes, enlaces, etc.\r\n\r\n- Punto 1\r\n- Punto 2\r\n\r\n![Descripción de la imagen](ruta/a/la/imagen.jpg)\r\n\r\n---\r\n\r\n### Subtítulo\r\n\r\nMás texto y contenido que quieras incluir.\r\n\r\n",
    "content": "<h1>Título principal</h1>\n<p>Aquí va el contenido del artículo en <strong>Markdown</strong>.</p>\n<p>Puedes usar listas, imágenes, enlaces, etc.</p>\n<ul>\n<li>Punto 1</li>\n<li>Punto 2</li>\n</ul>\n<p><img src=\"ruta/a/la/imagen.jpg\" alt=\"Descripción de la imagen\"></p>\n<hr>\n<h3>Subtítulo</h3>\n<p>Más texto y contenido que quieras incluir.</p>\n"
  },
  {
    "title": "Sobre el alcoholismo y su tratamiento desde el MBS",
    "description": "El estudio de Engel et al en el 2015 menciona que altos niveles de estres se pueden establecer como indicadores de riesgo de recaida en el consumo de alcohol, siendo indicadores tales como el uso de p",
    "tags": [],
    "summary": "El estudio de Engel et al en el 2015 menciona que altos niveles de estres se pueden establecer como indicadores de riesgo de recaida en el c...",
    "slug": "sobre-el-alcoholismo-y-su-tratamiento-desde-el-mbs",
    "raw": "El estudio de Engel et al en el 2015 menciona que altos niveles de estres se pueden establecer como indicadores de riesgo de recaida en el consumo de alcohol, siendo indicadores tales como el uso de psicometricos especificos para el estres como SCL-90 donde a mayor rango de estres mayor riesgo de consumo, a su vez tambien se menciona que los sub factores como Sensibilidad Interpersonal, ansiedad, y psicoticismo tienden a estar elevados en hasta dos puntos de diferencia sobre un grupo absitnente. Dado el modeo de investigacion se modela que el grupo abstinente se mantiene en ese estado en tanto los niveles de estres sean bajos especialmente en sub factores como estres somatico, depresion y ansiedad.\r\nEngel, Katharina & Schaefer, Martin & Stickel, Anna & Binder, Hennriette & Heinz, Andreas & Richter, Christoph. (2015). The Role of Psychological Distress in Relapse Prevention of Alcohol Addiction. Can High Scores on the SCL-90-R Predict Alcohol Relapse?. Alcohol and alcoholism (Oxford, Oxfordshire). 51. 10.1093/alcalc/agv062. \r\n\r\nEn el contexto de cambio se promueven decisiones y compromisos desde el individuo no desde la imposicion o coercion. \r\nMarco terapeutico\r\nSe busca que mejoren la autococinecia, aceptar sus experiencias y clarificar sus valores y vivir en formas basados en sus valores. Concientizacion implica apertura sin defensa hacia la experiencia, desde la practica del mindfulness desde los observar o confrontar de forma pasiva en vez de la evitacion y la autorefleccion desde la exploracion de los valores personales, revisitando los pensamientos , sentimientos y acciones explorando opciones y prioridades.  Se motiva a los individuos a aceptar sus experiencias antes que luchar contra estas mientras se aterriza sobre sus motivaciones y direccion de vida basado en sus valores personales. \r\nLa contraposicon interesante del modelo es que busca contrarestar la evitacion experiencial la cual tiende a autoreforzarse a corto plazo proponiendo una primera posicion \"incomoda\" de vivir la experiencia inmediata sin evitacion , sin reaccion para desarrollar perspectiva sobre lo que realmente importa.\r\n\r\nSe plantea la rigidez psicologica como fundamento del sufrimiento estableciendo el malestar que genera eventos fuera de nuestros contexto o modo de vida establecido (creencias) que tienden a reforzarse por el efecto de profecia autocumplida ** lo cual tiene seis procesos nucleares: evitacion experiencial * seamos concienste s o no tendemos a evitar experiencias incomodas que dentro del proposito terapeutico se inste a experimentar abiertamente algun grado de malestar emocional mientras se cumplen objetivos*, atencion inflexible * como la tendencia instintiva de llevar el foco de atencion sobre el pasado o el futuro anticipado mientras omitimos el presente* , apego a un yo conceptualizado *implica quedarse en la etiqueta tanto heredada como entregada por otros, limitando la capacidad de uno mismo hacia lo cree que puede hacer frente a lo que puede hacer en el proposito terapeutico se busca que se vea a si mismo como contexto* ,  fusion cognitiva *implica ese apego irreflenable hacia las experiencias internas, dando valor de realidad a creenciasy a emociones  como directrices de accion.*, disrupcion de los valores escogidos *lo cual remite a mantener conductas que refuerzan creencias y establecemos creencias como normas de vida o valores contraproducentes* y la dinamica inaccion o impuslvidad *como una respuesta de gratificacion inmediata  que a largo plazo genera malestar y cuya propuesta terapeutica es la accion con compromiso * .\r\nMBS, 14",
    "content": "<p>El estudio de Engel et al en el 2015 menciona que altos niveles de estres se pueden establecer como indicadores de riesgo de recaida en el consumo de alcohol, siendo indicadores tales como el uso de psicometricos especificos para el estres como SCL-90 donde a mayor rango de estres mayor riesgo de consumo, a su vez tambien se menciona que los sub factores como Sensibilidad Interpersonal, ansiedad, y psicoticismo tienden a estar elevados en hasta dos puntos de diferencia sobre un grupo absitnente. Dado el modeo de investigacion se modela que el grupo abstinente se mantiene en ese estado en tanto los niveles de estres sean bajos especialmente en sub factores como estres somatico, depresion y ansiedad.\nEngel, Katharina &amp; Schaefer, Martin &amp; Stickel, Anna &amp; Binder, Hennriette &amp; Heinz, Andreas &amp; Richter, Christoph. (2015). The Role of Psychological Distress in Relapse Prevention of Alcohol Addiction. Can High Scores on the SCL-90-R Predict Alcohol Relapse?. Alcohol and alcoholism (Oxford, Oxfordshire). 51. 10.1093/alcalc/agv062.</p>\n<p>En el contexto de cambio se promueven decisiones y compromisos desde el individuo no desde la imposicion o coercion.\nMarco terapeutico\nSe busca que mejoren la autococinecia, aceptar sus experiencias y clarificar sus valores y vivir en formas basados en sus valores. Concientizacion implica apertura sin defensa hacia la experiencia, desde la practica del mindfulness desde los observar o confrontar de forma pasiva en vez de la evitacion y la autorefleccion desde la exploracion de los valores personales, revisitando los pensamientos , sentimientos y acciones explorando opciones y prioridades.  Se motiva a los individuos a aceptar sus experiencias antes que luchar contra estas mientras se aterriza sobre sus motivaciones y direccion de vida basado en sus valores personales.\nLa contraposicon interesante del modelo es que busca contrarestar la evitacion experiencial la cual tiende a autoreforzarse a corto plazo proponiendo una primera posicion &quot;incomoda&quot; de vivir la experiencia inmediata sin evitacion , sin reaccion para desarrollar perspectiva sobre lo que realmente importa.</p>\n<p>Se plantea la rigidez psicologica como fundamento del sufrimiento estableciendo el malestar que genera eventos fuera de nuestros contexto o modo de vida establecido (creencias) que tienden a reforzarse por el efecto de profecia autocumplida ** lo cual tiene seis procesos nucleares: evitacion experiencial * seamos concienste s o no tendemos a evitar experiencias incomodas que dentro del proposito terapeutico se inste a experimentar abiertamente algun grado de malestar emocional mientras se cumplen objetivos*, atencion inflexible * como la tendencia instintiva de llevar el foco de atencion sobre el pasado o el futuro anticipado mientras omitimos el presente* , apego a un yo conceptualizado <em>implica quedarse en la etiqueta tanto heredada como entregada por otros, limitando la capacidad de uno mismo hacia lo cree que puede hacer frente a lo que puede hacer en el proposito terapeutico se busca que se vea a si mismo como contexto</em> ,  fusion cognitiva <em>implica ese apego irreflenable hacia las experiencias internas, dando valor de realidad a creenciasy a emociones  como directrices de accion.</em>, disrupcion de los valores escogidos <em>lo cual remite a mantener conductas que refuerzan creencias y establecemos creencias como normas de vida o valores contraproducentes</em> y la dinamica inaccion o impuslvidad *como una respuesta de gratificacion inmediata  que a largo plazo genera malestar y cuya propuesta terapeutica es la accion con compromiso * .\nMBS, 14</p>\n"
  }
];
        // __BLOG_POSTS_DATA__

        const md = window.markdownit ? window.markdownit() : null;

        function ensure(selector) {
            const el = document.querySelector(selector);
            if (!el) console.warn('No existe', selector);
            return el;
        }

        /* Pestañas y renderizado */
        function initTabsArea() {
            const blogView = ensure('#blog-view');
            if (!blogView) return;
            if (document.getElementById('tabsWrapper')) return;
            const tabsWrapper = document.createElement('div');
            tabsWrapper.id = 'tabsWrapper';
            tabsWrapper.className = 'mb-6';
            tabsWrapper.innerHTML = `
                <div id="tabsHeader" class="flex items-center gap-2 overflow-x-auto pb-2"></div>
                <div id="tabsContent" class="space-y-4"></div>
            `;
            blogView.insertBefore(tabsWrapper, blogView.firstChild);
        }

        const openTabs = new Map();

        function activateTab(slug) {
            document.querySelectorAll('#tabsHeader [data-slug]').forEach(h => h.classList.toggle('bg-white', h.dataset.slug === slug));
            document.querySelectorAll('#tabsContent [data-slug]').forEach(p => p.classList.toggle('hidden', p.dataset.slug !== slug));
            // actualizar hash sin crear historial extra
            if (slug && location.hash !== `#${slug}`) history.replaceState(null, '', `#${slug}`);
        }

        function closeTab(slug) {
            const head = document.querySelector(`#tabsHeader [data-slug="${slug}"]`);
            const panel = document.querySelector(`#tabsContent [data-slug="${slug}"]`);
            if (head) head.remove();
            if (panel) panel.remove();
            openTabs.delete(slug);
            const last = Array.from(openTabs.keys()).pop();
            if (last) activateTab(last);
            else history.replaceState(null, '', location.pathname + location.search);
        }

        function openTabForPost(post) {
            initTabsArea();
            const slug = post.slug || (post.title || 'post').toLowerCase().replace(/\s+/g, '-');
            if (openTabs.has(slug)) { activateTab(slug); return; }

            const headerBtn = document.createElement('button');
            headerBtn.dataset.slug = slug;
            headerBtn.className = 'px-4 py-2 rounded-full bg-white shadow text-sm flex items-center gap-2';
            headerBtn.innerHTML = `<span class="font-medium truncate max-w-xs">${post.title || 'Sin título'}</span><span class="ml-2 text-gray-400 hover:text-red-500 cursor-pointer close-tab">✕</span>`;
            headerBtn.addEventListener('click', (e) => {
                if (e.target && e.target.classList && e.target.classList.contains('close-tab')) { closeTab(slug); e.stopPropagation(); return; }
                activateTab(slug);
            });
            document.getElementById('tabsHeader').appendChild(headerBtn);

            const panel = document.createElement('div');
            panel.dataset.slug = slug;
            panel.className = 'bg-white rounded-xl shadow-lg p-6';
            panel.innerHTML = `
                <div class="mb-4">
                    <span class="text-sm font-semibold text-indigo-600">${post.category || 'Sin categoría'}</span>
                    <h1 class="mt-2 text-2xl font-bold text-gray-900">${post.title || ''}</h1>
                    <p class="mt-2 text-gray-600">${post.description || post.summary || ''}</p>
                </div>
                <div class="prose max-w-none mt-4 text-gray-700">
                    ${post.content || (md ? md.render(post.raw || '') : (post.raw || ''))}
                </div>
            `;
            document.getElementById('tabsContent').appendChild(panel);

            openTabs.set(slug, { header: headerBtn, panel });
            activateTab(slug);
            headerBtn.scrollIntoView({ behavior: 'smooth', inline: 'end' });
        }

        /* Renderizado de listado y filtros */
        function renderPosts(container, posts) {
            container.innerHTML = '';
            posts.forEach(post => {
                const article = document.createElement('article');
                article.className = 'bg-white rounded-xl shadow-lg transition-shadow duration-300 overflow-hidden';
                const category = post.category || 'Sin categoría';
                article.innerHTML = `
                    <div class="p-6">
                        <span class="text-sm font-semibold text-indigo-600">${category}</span>
                        <h2 class="mt-2 text-2xl font-bold text-gray-900 cursor-pointer title-link">${post.title || 'Sin título'}</h2>
                        <p class="mt-2 text-gray-600">${post.summary || ''}</p>
                        <div class="mt-4 prose prose-indigo text-gray-600 hidden">${post.content || (md ? md.render(post.raw || '') : '')}</div>
                        <div class="mt-4 flex gap-2">
                            <button class="open-tab-btn bg-indigo-500 text-white px-3 py-1 rounded-full text-sm">Abrir</button>
                            <button class="view-inline-btn bg-gray-100 text-gray-700 px-3 py-1 rounded-full text-sm">Ver rápido</button>
                        </div>
                    </div>
                `;
                article.querySelector('.open-tab-btn').addEventListener('click', () => openTabForPost(post));
                article.querySelector('.title-link').addEventListener('click', () => openTabForPost(post));
                article.querySelector('.view-inline-btn').addEventListener('click', () => {
                    const preview = article.querySelector('.prose');
                    if (preview) preview.classList.toggle('hidden');
                });
                container.appendChild(article);
            });
        }

        function renderFilters(container, posts) {
            container.innerHTML = '';
            const categories = [...new Set(posts.map(p => p.category || 'Sin categoría'))].filter(Boolean);
            const allButton = document.createElement('button');
            allButton.textContent = 'Todas';
            allButton.className = 'bg-indigo-500 text-white rounded-full px-4 py-2 font-semibold text-sm shadow-md';
            allButton.onclick = () => filterPosts('all', container);
            container.appendChild(allButton);
            categories.forEach(cat => {
                const btn = document.createElement('button');
                btn.textContent = cat;
                btn.className = 'bg-gray-200 text-gray-700 rounded-full px-4 py-2 font-semibold text-sm';
                btn.onclick = () => filterPosts(cat, container);
                container.appendChild(btn);
            });
        }

        function filterPosts(category, filtersContainer) {
            const postsContainer = ensure('#blog-posts');
            if (!postsContainer) return;
            if (category === 'all') renderPosts(postsContainer, blogPosts);
            else renderPosts(postsContainer, blogPosts.filter(p => (p.category || 'Sin categoría') === category));
        }

        /* Deep linking: abrir pestaña si hay hash */
        function openFromHash() {
            const hash = location.hash.replace('#', '');
            if (!hash) return;
            const post = blogPosts.find(p => p.slug === hash);
            if (post) openTabForPost(post);
        }

        /* Inicialización */
        window.addEventListener('DOMContentLoaded', () => {
            initTabsArea();
            const postsContainer = ensure('#blog-posts');
            const filtersContainer = ensure('#category-filters');
            if (postsContainer && Array.isArray(blogPosts)) renderPosts(postsContainer, blogPosts);
            if (filtersContainer && Array.isArray(blogPosts)) renderFilters(filtersContainer, blogPosts);
            openFromHash();
        });

        window.addEventListener('hashchange', openFromHash);
    </script>
</body>
</html>
